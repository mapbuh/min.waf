ban_time: 600
lockfile: /var/run/min.waf.pid
time_frame: 300
proxy_listen_host: 127.0.0.1
proxy_listen_port: 9009
whitelist_permanent: "/etc/min.waf.whitelist"
# whitelist specific ips, that are authenticated users or internal services
whitelist_triggers:
  example.com:
  - http_status: '200'
    path: /admin/dashboard
  - http_status: '200'
    path: /admin/reports/index
  wordpress.example.com:
  - http_status: '200'
    path: /wp-admin/
bots:
  Bing:
    user_agent: Bingbot
    ip_ranges_url: https://www.bing.com/toolbox/bingbot.json
    action: allow
  DuckDuckGo:
    user_agent: DuckDuckBot
    ip_ranges_url: https://duckduckgo.com/duckduckbot.json
    action: allow
  Google:
    user_agent: Google
    ip_ranges_url: https://developers.google.com/static/search/apis/ipranges/googlebot.json
    action: allow
  OAI-GPTBot:
    user_agent: GPTBot
    ip_ranges_url: https://openai.com/gptbot.json
    action: allow
  OAI-SearchBot:
    user_agent: OAI-SearchBot
    ip_ranges_url: https://openai.com/searchbot.json
    action: allow
good_bots:
  Ad.Min:
    - 'https://ad.min.solutions'
  Babbar:
    - 'https://www.babbar.tech/crawler'
  Facebook:
    - 'https://developers.facebook.com/docs/sharing/webmasters/crawler'
    - 'http://www.facebook.com/bot.html'
    - 'http://www.facebook.com/externalhit_uatext.php'
  Majestic:
    - 'http://mj12bot.com/'
  Monit:
    - 'Monit/5.33.0'
  SentryUptimeBot:
    - 'http://docs.sentry.io/product/alerts/uptime-monitoring/'
bad_bots:
  Mozlila:
    - 'Mozlila/5.0'
  Python:
    - 'python-urllib'
    - 'python-requests'
    - 'python-http'
    - 'aiohttp/'
  Go-http-client:
    - 'Go-http-client/'
  'Redtail':
    - 'libredtail-http'
# requesting these result in immediate bans if http_status is 404 or 500
known_attacks:
- ".git/credentials"
- "/.aws/config"
- "/.aws/credentials"
- "/.env.backup"
- "/.env.dev"
- "/.env.local"
- "/.env.production"
- "/.env.staging"
- "/.env.test"
- "/.env"
- "/.git/config"
- "/.htpasswd"
- "/222.php"
- "/abcd.php"
- "/alfa.php"
- "/alphanew.php"
- "/atomlib.php"
- "/aws-secret.yaml"
- "/cmd.php"
- "/config/aws.yml"
- "/enclass.php"
- "/gifclass.php"
- "/ioxi-o.php"
- "/lock360.php"
- "/lv.php"
- "/nc4.php"
- "/shell.php"
- "/system_log.php"
- "/vee.php"
- "admin.php"
- "install.php"
- "phpinfo.php"
- "wp-admin"
- "wp-content/plugins/hellopress/wp_filemanager.php"
- "wp-includes/ID3/license.txt"
- "wp-includes/wlwmanifest.xml"
- "wp-login.php"
- "xmlrpc.php"
# ip_blacklist_refresh_time: 7200
# ip_blacklist: https://example.com/blacklist/ip-list.txt
# less important
detail_lines: 12
refresh_time: 1
ua_stats: true
url_stats: true
